
module.exports = function(grunt) {
	grunt.initConfig({
//		pkg: '<json:package.json>',
		
		jsx: {
			race:{
				src: ['jsx/race.jsx'],
				dest: 'jsx.js/race.js'
			}
		},
	});
	
	var proc = require('child_process');
	grunt.registerMultiTask('jsx','compile jsx script', function() {
		var done = this.async();
		var src = this.file.src;
		var command = 'jsx --release --enable-source-map --output ' + this.file.dest + ' ' + src;
		var out = proc.exec(command, function(err, sout, serr){
			if(err || sout || serr){
				//grunt.log.writeln('---------');
				grunt.log.error(serr);
				//grunt.log.writeln('---------');
				done(false);
			}else{
				grunt.log.writeln(src+" is compiled");
				done(true);
			}
		});
		
	});
};


